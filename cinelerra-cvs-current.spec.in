# This is not relocatable
%define prefix /usr

Summary: Cinelerra CVS
Name: cinelerra
#Version: 1.2.0.cvs.cobra
Version: @VERSION@.cvs.%{build_nick}
Release: %(date '+%Y%m%d')
License: GPL
Group: X11
URL: http://cvs.cinelerra.org
#Source0: %{name}-%{version}.tar.gz
#Source0: %{name}-1.2.0.tar.gz
Source0: %{name}-@VERSION@.tar.gz
#BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-buildroot
#BuildRoot: %{_tmppath}/%{name}-1.2.0-%{release}-buildroot
BuildRoot: %{_tmppath}/%{name}-@VERSION@-%{release}-buildroot
Requires: mjpegtools >= 1.6.3

%description
Cinelerra unofficial cvs package

%prep
# %setup -q
# %setup -n cinelerra-1.2.0
%setup -n %{name}-@VERSION@

%build
./configure --prefix=%{prefix}
#./configure
%{__make} %{?_smp_mflags} %{?mflags}

%install
rm -rf $RPM_BUILD_ROOT
make prefix=$RPM_BUILD_ROOT%{prefix} install
# rename the mpeg3 utils so they can be installed alongside SuSE native versions
( cd $RPM_BUILD_ROOT%{prefix}/bin
  mv mpeg3toc mpeg3toc.hv
  mv mpeg3cat mpeg3cat.hv
  mv mpeg3dump mpeg3dump.hv
#  cd $RPM_BUILD_ROOT%{prefix}/lib
  ln -s /usr/bin/mpeg2enc $RPM_BUILD_ROOT%{prefix}/lib/cinelerra/mpeg2enc.plugin
)

%clean
rm -rf $RPM_BUILD_ROOT

%files
%defattr(-,root,root,-)
%doc
#%{prefix}/bin/*
%{prefix}/bin/cinelerra

# missing in the 2.0 build?
#%{prefix}/bin/mplexhi
%{prefix}/bin/mplexlo

#%exclude %{prefix}/bin/mpeg3dump
#%exclude %{prefix}/bin/mpeg3toc
#%exclude %{prefix}/bin/mpeg3cat
%{prefix}/bin/mpeg3dump.hv
%{prefix}/bin/mpeg3toc.hv
%{prefix}/bin/mpeg3cat.hv
#%{prefix}/lib/*
%{prefix}/share/locale/*
%exclude %{prefix}/include/*

%{prefix}/lib/cinelerra/*.so
%{prefix}/lib/cinelerra/mpeg2enc.plugin
%{prefix}/lib/cinelerra/shapewipe/*

# remove below for no static libs
# %exclude %{prefix}/lib/cinelerra/*.a
%exclude %{prefix}/lib/cinelerra/*.la

%{prefix}/lib/cinelerra/fonts/*

%{prefix}/lib/libguicast*
%{prefix}/lib/libmpeg3hv*
%{prefix}/lib/libquicktimehv*
# missing in 2.0
#%{prefix}/lib/libsndfilehv*
#%{prefix}/lib/pkgconfig*

%{prefix}/share/applications/cinelerra.desktop
%{prefix}/share/pixmaps/cinelerra.xpm


%changelog
* Sat Feb 04 2006 Kevin Brosius <cobra@compuserve.com> - 2.0.0.cvs.cobra-date
- vertical pos of auto-zoom text, dv audio offset/framing fix
- Italian translation, Spanish update, deinterlace fix
- mpeg encode params fix

* Sat Jan 26 2006 Kevin Brosius <cobra@compuserve.com> - 2.0.0.cvs.cobra-date
- raw dv i/o fixes, textual info for labels, " conversion
- Automation text label editable, audio_position adjust for dv1394

* Sat Dec 24 2005 Kevin Brosius <cobra@compuserve.com> - 2.0.0.cvs.cobra-date
- fix bug 219 & 220, make text menu hilight white
- alt+left/right navigates trough edit handles
- parameter name fix, single image dnd fixes, remove mwindowmove dup code
- ffmpeg defaults for elem stream (Bug 164), member function fix
- gettextize language changes for more plugins, French update

* Sun Dec 11 2005 Kevin Brosius <cobra@compuserve.com> - 2.0.0.cvs.cobra-date
- Fix renderfarm client crash, align cursor on frames default
- right mouse on keyframe - keyframe popup, guicast / gettextize additions
- Brazilian update, French update
- link mpeg2enc.plugin for SUSE, add mjpegtools >= 1.6.3 dep

* Mon Nov 14 2005 Kevin Brosius <cobra@compuserve.com> - 2.0.0.cvs.cobra-date
- Initial build of CV from svn tree.


